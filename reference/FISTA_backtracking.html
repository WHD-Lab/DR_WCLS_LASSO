<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>FISTA_backtracking — FISTA_backtracking • MRTpostInfLASSO</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="FISTA_backtracking — FISTA_backtracking"><meta name="description" content='This fuction applies the FISTA algorithm with backtracking to solve randomized LASSO problem. Reference paper is
"A Fast Iterative Shrinkage-Thresholding Algorithm for Linear Inverse Problems" by Amir Beck and Marc Teboulle.'><meta property="og:description" content='This fuction applies the FISTA algorithm with backtracking to solve randomized LASSO problem. Reference paper is
"A Fast Iterative Shrinkage-Thresholding Algorithm for Linear Inverse Problems" by Amir Beck and Marc Teboulle.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MRTpostInfLASSO</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tutorial.html">MRTpostInfLASSO</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>FISTA_backtracking</h1>

      <div class="d-none name"><code>FISTA_backtracking.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This fuction applies the FISTA algorithm with backtracking to solve randomized LASSO problem. Reference paper is
"A Fast Iterative Shrinkage-Thresholding Algorithm for Linear Inverse Problems" by Amir Beck and Marc Teboulle.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FISTA_backtracking</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">ID</span>,</span>
<span>  <span class="va">moderator_formula</span>,</span>
<span>  lam <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  noise_scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  splitrat <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  max_ite <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>the output of pseudo_outcomecal function</p></dd>


<dt id="arg-id">ID<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>the name of column where participants' ID are stored</p></dd>


<dt id="arg-moderator-formula">moderator_formula<a class="anchor" aria-label="anchor" href="#arg-moderator-formula"></a></dt>
<dd><p>determines the formula for the f(St)T*beta function</p></dd>


<dt id="arg-lam">lam<a class="anchor" aria-label="anchor" href="#arg-lam"></a></dt>
<dd><p>the value of penalty term of randomized LASSO. If it is not provided, the default value will be used.
Default is
\(\sqrt{2n* logp} \rho sd(y)\) where \(\rho\)
is the split rate and \(n\) is the number of rows.</p></dd>


<dt id="arg-noise-scale">noise_scale<a class="anchor" aria-label="anchor" href="#arg-noise-scale"></a></dt>
<dd><p>Standard deviation of Gaussian noise added to objective.
Default is \(\sqrt{\frac{1-\rho}{\rho}\, n}\,\mathrm{sd}(y)\) where \(\rho\)
is the split rate and \(n\) is the number of rows.
The random noises, \(\omega\), are iid drawn from normal distribution with standard deviation noise_scale</p></dd>


<dt id="arg-splitrat">splitrat<a class="anchor" aria-label="anchor" href="#arg-splitrat"></a></dt>
<dd><p>this value is corresponding to the data splitting rate. Details can read "Exact Selective Inference with Randomization" page 15 equation (10).
This value will be used only when user doesn't provide the <code>noise_scale</code> or <code>lam</code>.</p></dd>


<dt id="arg-max-ite">max_ite<a class="anchor" aria-label="anchor" href="#arg-max-ite"></a></dt>
<dd><p>the maximum iteration for searching predictors</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>when the improvement of residual sum of square less than this number, stop searching</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>the true coefficient value (if simulation is conducted)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<dl><dt>formula</dt>
<dd><p>the raw model before selection</p></dd>

<dt>E</dt>
<dd><p>Selected variables</p></dd>

<dt>NE</dt>
<dd><p>Not selected variables</p></dd>

<dt>n</dt>
<dd><p>the number of participants in the study</p></dd>

<dt>soln</dt>
<dd><p>Estimated coefficients of selected variables from the penalized randomized regression.</p></dd>

<dt>Z</dt>
<dd><p>Subgradient of unselected variables.</p></dd>

<dt>OMEGA</dt>
<dd><p>The scaled variance for the added random noise. This value is scaled by 4.</p></dd>

<dt>lam</dt>
<dd><p>Scale orginal regularization parameter by -2 for later inference purpose.</p></dd>

<dt>ori_lam</dt>
<dd><p>Regularization parameter (lambda) used in the penalization.</p></dd>

<dt>perturb</dt>
<dd><p>Random noise added for each variables. This value is scaled by -2 for later inference purpose.</p></dd>

<dt>nonzero</dt>
<dd><p>Boolean vector indicating which variables were selected.</p></dd>

<dt>postbeta</dt>
<dd><p>True beta projected on space spinned by post-selection predictors</p></dd>

<dt>sign_soln</dt>
<dd><p>Signs of the estimated coefficients for selected variables</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sim_data</span> <span class="op">=</span> <span class="fu"><a href="generate_dataset.html">generate_dataset</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, T <span class="op">=</span> <span class="fl">40</span>, P <span class="op">=</span> <span class="fl">50</span>, sigma_residual <span class="op">=</span> <span class="fl">1.5</span>, sigma_randint <span class="op">=</span> <span class="fl">1.5</span>, main_rand <span class="op">=</span> <span class="fl">3</span>, rho <span class="op">=</span> <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>  beta_logit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1.6</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span>, model <span class="op">=</span> <span class="op">~</span> <span class="va">state1</span> <span class="op">+</span> <span class="va">state2</span> <span class="op">+</span> <span class="va">state3</span> <span class="op">+</span> <span class="va">state4</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1.7</span>, <span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  theta1 <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"state"</span>,<span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">St</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"state"</span>,<span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pseudo_outcome_CVlasso</span> <span class="op">=</span> <span class="fu"><a href="pseudo_outcome_generator_CVlasso.html">pseudo_outcome_generator_CVlasso</a></span><span class="op">(</span>fold <span class="op">=</span> <span class="fl">5</span>,ID <span class="op">=</span> <span class="st">"id"</span>, <span class="va">sim_data</span>, <span class="va">Ht</span>,</span></span>
<span class="r-in"><span>  <span class="va">St</span>, <span class="st">"action"</span>, <span class="st">"outcome"</span>,core_num <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in pseudo_outcome_generator_CVlasso(fold = 5, ID = "id", sim_data,     Ht, St, "action", "outcome", core_num = 5):</span> argument "outcome" is missing, with no default</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">my_formula</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"yDR ~ "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">St</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">FISTA_backtracking</span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_data</span>, moderator_formula <span class="op">=</span> <span class="va">my_formula</span>, lam <span class="op">=</span> <span class="cn">NULL</span>, noise_scale <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  splitrat <span class="op">=</span> <span class="fl">0.7</span>, beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1.7</span>, <span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1.3</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `[.data.frame`(data, , "ptSt"):</span> undefined columns selected</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yuxuan Chen, Yaxuan Huang, Walter Dempsey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

