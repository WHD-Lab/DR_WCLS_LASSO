% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/UI_function_grids.R
\name{DR_WCLS_LASSO}
\alias{DR_WCLS_LASSO}
\title{DR_WCLS_LASSO}
\usage{
DR_WCLS_LASSO(
  data,
  fold,
  ID,
  time,
  Ht,
  St,
  At,
  prob,
  outcome,
  method_pesu,
  lam = NULL,
  noise_scale = NULL,
  splitrat = 0.8,
  virtualenv_path = "",
  beta = NULL,
  level = 0.9,
  core_num = NULL,
  CI_algorithm = "lapply",
  max_iterate = 10^{
     6
 },
  max_tol = 10^{
     -3
 },
  varSelect_program = "Python",
  standardize_x = TRUE,
  standardize_y = TRUE
)
}
\arguments{
\item{data}{A data frame with one row per decision time (raw data; no pseudo-outcomes).}

\item{fold}{Number of folds used when estimating nuisance functions for the pseudo-outcome.}

\item{ID}{Column name of the participant identifier.}

\item{time}{Column name of the time-in-study (decision point).}

\item{Ht}{A vector specifying history features.}

\item{St}{A vector specifying moderator features.}

\item{At}{Column name of the treatment indicator.}

\item{prob}{Column name of the design probability \eqn{p_t(A_t=1 \mid H_t)}.}

\item{outcome}{Column name of the outcome.}

\item{method_pesu}{ML method used to estimate nuisance functions for the
pseudo-outcome. One of \code{"CVLASSO"}, \code{"RandomForest"}, \code{"GradientBoosting"}.}

\item{lam}{Penalty value for randomized LASSO; if \code{NULL}, a default is used.}

\item{noise_scale}{Gaussian noise added to the objective.
Default is \eqn{\sqrt{\frac{1-\rho}{\rho}\, n}\,\mathrm{sd}(y)} where \eqn{\rho}
is the split rate and \eqn{n} is the number of rows.}

\item{splitrat}{Data splitting rate \eqn{\rho}; used only if \code{noise_scale} is \code{NULL}.}

\item{virtualenv_path}{Path to a Python virtual environment (for \code{reticulate})
when \code{varSelect_program = "Python"}.}

\item{beta}{True coefficients (for simulation use only).}

\item{level}{Confidence level (e.g., \code{0.90} for a 90\% interval).}

\item{core_num}{Number of cores to use for parallel computation.}

\item{CI_algorithm}{Method for CI computation: one of \code{"lapply"}, \code{"parallel"}, \code{"doParallel"}.}

\item{max_iterate}{Maximum number of iterations used when searching for CI bounds.}

\item{max_tol}{Maximum tolerance for the pivot error. Default \eqn{10^{-3}}.}

\item{varSelect_program}{\code{"Python"} (requires a valid \code{virtualenv_path}) or \code{"R"}.}

\item{standardize_x, standardize_y}{Whether to standardize design matrix/outcome.}
}
\value{
\describe{
\item{selected_vars}{Selected variables.}
\item{gee_est}{GEE estimates.}
\item{p_value}{P-values for selected variables.}
\item{CIs}{Confidence intervals.}
\item{pivot_lower}{Target pivot value at the lower CI bound.}
\item{pivot_upper}{Target pivot value at the upper CI bound.}
}
}
\description{
Fit a basic doubly robust weighted centered least squares (DR-WCLS)
model with variable selection.
}
\details{
The function generates a pseudo-outcome,
performs variable selection, then conducts DR-WCLS to obtain
inference with confidence intervals. Parallelism can be enabled via
\code{CI_algorithm = "parallel"} or \code{"doParallel"}.
}
\examples{
df = data.frame(
    id = rep(1:10, each = 5),
    decision_point = rep(1:5, times = 10),
    intervention = rbinom(50, 1, 0.5),
    rand_prob = 0.5,
    logstep_30min = rnorm(50),
    logstep_30min_lag1 = rnorm(50),
    logstep_pre30min = rnorm(50),
    is_at_home_or_work = sample(0:1, 50, TRUE),
    day_in_study = rep(1:5, times = 10)
  )
Ht = c('logstep_30min_lag1','logstep_pre30min','is_at_home_or_work', 'day_in_study')
St = c('logstep_30min_lag1','logstep_pre30min','is_at_home_or_work', 'day_in_study')
UI_return = DR_WCLS_LASSO(
  data = data, fold = 5, ID = "id", time = "decision_point",
  At = "intervention", prob = "rand_prob", outcome = "logstep_30min",
  method_pesu = "CVLASSO", lam = NULL, noise_scale = NULL, splitrat = 0.8,
  beta = c(-0.2, 0.8, 0.3, 0.7, 0.3, rep(0, 21)),
  level = 0.90, core_num = 3, CI_algorithm = "parallel",
  varSelect_program = "R"
)


}
